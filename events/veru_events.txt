namespace = veru

# List Subjects
country_event = {
	id = veru.1000
	title = veru.1000.name
	desc = {
		trigger = { check_variable = { which = veru_total_subjects value > 0 } }
		text = veru.1000.desc
	}
	desc = {
		trigger = { check_variable = { which = veru_total_subjects value = 0 } }
		text = veru.1000.desc.fail
	}
	picture = GFX_evt_enclave_overlord
	show_sound = event_laboratory_sound
	location = ROOT

	is_triggered_only = yes

	# No valid target
	option = {
		name = UNFORTUNATE
		trigger = { check_variable = { which = veru_total_subjects value = 0 } }
	}

	option = {
		name = veru.nevermind
		trigger = { check_variable = { which = veru_total_subjects value > 0 } }
	}

	# Now we show a list of the subject states to the player
	option = {
		inline_script = { script = events/pick_subject_option NUM = 1 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 2 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 3 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 4 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 5 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 6 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 7 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 8 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 9 }
	}
	option = {
		inline_script = { script = events/pick_subject_option NUM = 10 }
	}
}

# Pick Action: Changing Name, Subject Type, Changing Government Structure, Installing New Leader, Give Technology
country_event = {
	id = veru.1050
	title = veru.1050.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.1050.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.1050.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Back
	option = { name = veru.nevermind }

	# Install New Leader
	option = {
		name = veru.1050.leader
		allow = {
			custom_tooltip = {
				fail_text = contract_fail
				event_target:chosen_subject = {
					is_gestalt = no
					has_ruler_alllowed = yes
				}
			}
		}
		hidden_effect = {
			country_event = { id = veru.5000 }
		}
	}

	# Alter Government Type
	option = {
		name = veru.1050.gov
		allow = {
			custom_tooltip = {
				fail_text = contract_fail
				event_target:chosen_subject = {
					is_gestalt = no
					has_government_allowed = yes
				}
			}
		}
		hidden_effect = {
			country_event = { id = veru.4000 }
		}
	}

	# Empower Specific Faction
	option = {
		name = veru.1050.faction
		allow = {
			custom_tooltip = {
				fail_text = contract_fail
				event_target:chosen_subject = {
					is_gestalt = no
					has_government_allowed = yes
				}
			}
			custom_tooltip = {
				fail_text = EMPOWER_FACTION_COOLDOWN
				event_target:chosen_subject = {
					NOT = { has_modifier = embraced_faction_timer }
				}
			}
		}
		hidden_effect = {
			country_event = { id = veru.3000 }
		}
	}

	# Relocate Capital
	option = {
		name = veru.1050.cap
		allow = {
			custom_tooltip = {
				fail_text = contract_fail
				event_target:chosen_subject = { has_capital_allowed = yes }
			}
			custom_tooltip = {
				fail_text = veru_tree_of_life_fail
				event_target:chosen_subject = { NOT = { has_origin = origin_tree_of_life } }
			}
		}
		hidden_effect = {
			event_target:chosen_subject = { get_relocation_planets = yes }
			country_event = { id = veru.6700 }
		}
	}

	# Proxy War
	option = {
		name = veru.1050.proxy
		allow = {
			custom_tooltip = {
				fail_text = contract_fail
				event_target:chosen_subject = { has_proxy_allowed = yes }
			}
		}
		hidden_effect = {
			save_event_target_as = ver_puppeteer
			event_target:chosen_subject = {
				country_event = { id = ver.32 }
			}
		}
	}

	# Alter Subject Name
	option = {
		name = veru.1050.name_change
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru
				has_resource = { type = influence amount >= 100 }
			}
			custom_tooltip = {
				fail_text = contract_fail
				event_target:chosen_subject = { has_naming_alllowed = yes }
			}
		}
		hidden_effect = {
			country_event = { id = veru.2000 }
		}
	}

	# Give All Technologies
	option = {
		name = veru.1050.tech
		custom_tooltip = veru.1050.tech.tooltip
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_200
				has_resource = { type = influence amount >= 200 }
			}
		}
		add_resource = { influence = -200 }
		hidden_effect = {
			event_target:chosen_subject = { copy_techs_from = { target = root } }
			country_event = { id = veru.1050 }
		}
	}
}

############
# Change Subject Names
country_event = {
	id = veru.2000
	title = veru.subject_leader.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.2000.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.2000.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Do something else
	option = {
		name = veru.something_else
		hidden_effect = {
			country_event = { id = veru.1050 }
		}
	}

	# Change Empire Name
	option = {
		name = veru.2000.empire
		custom_tooltip = veru.2000.empire_name_change.tooltip
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_25
				has_resource = { type = influence amount >= 25 }
			}
		}
		add_resource = { influence = -25 }
		hidden_effect = {
			event_target:chosen_subject = { set_name = { key = NAME_capital_solar_system variable_string = "[root.capital_scope.solar_system.GetName]" } }
			get_intervention_effect = yes
		}
	}
	
	## Broken by PDX. Will renable when they fix it.
	# # Change Male Ruler Title
	# option = {
	# 	name = veru.2000.male_ruler_title
	# 	custom_tooltip = veru.2000.male_ruler_title_name_change.tooltip
	# 	allow = {
	# 		custom_tooltip = {
	# 			fail_text = influencefail_text_veru_15
	# 			has_resource = { type = influence amount >= 15 }
	# 		}
	# 	}
	# 	add_resource = { influence = -15 }
	# 	hidden_effect = {
	# 		event_target:chosen_subject = { set_male_ruler_title = NAME_capital_solar_system }
	# 		get_intervention_effect = yes
	# 	}
	# }

	# # Change Female Ruler Title
	# option = {
	# 	name = veru.2000.female_ruler_title
	# 	custom_tooltip = veru.2000.female_ruler_title_name_change.tooltip
	# 	allow = {
	# 		custom_tooltip = {
	# 			fail_text = influencefail_text_veru_15
	# 			has_resource = { type = influence amount >= 15 }
	# 		}
	# 	}
	# 	add_resource = { influence = -15 }
	# 	hidden_effect = {
	# 		event_target:chosen_subject = { set_female_ruler_title = "[root.capital_scope.solar_system.GetName]" }
	# 		get_intervention_effect = yes
	# 	}
	# }

	# Back
	option = { name = veru.remain }
}

############
# Government

# Empower Specific Faction
country_event = {
	id = veru.3000
	title = veru.subject_leader.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.4000.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.4000.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Do something else
	option = {
		name = veru.something_else
		hidden_effect = {
			country_event = { id = veru.1050 }
		}
	}

	# Empower Authoritarians
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = authoritarian }
	}

	# Empower Egalitarians
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = egalitarian }
	}

	# Empower Spiritualists
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = spiritualist }
	}

	# Empower Materialists
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = materialist }
	}

	# Empower Militarists
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = militarist }
	}

	# Empower Pacifists
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = pacifist }
	}

	# Empower Xenophobes
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = xenophobe }
	}

	# Empower Xenophiles
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = xenophile }
	}

	# Empower Socialists
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = socialism }
	}

	# Empower Capitalists
	option = {
		inline_script = { script = events/pick_faction_option ETHIC = capitalism }
	}

	# Back
	option = { name = veru.remain }
}

# Change Government Structure
country_event = {
	id = veru.4000
	title = veru.subject_leader.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.4000.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.4000.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Do something else
	option = {
		name = veru.something_else
		hidden_effect = {
			country_event = { id = veru.1050 }
		}
	}

	# Transform into Dictatorial
	option = {
		name = veru.4000.dictatorial
		trigger = {
			event_target:chosen_subject = { NOT = { has_authority = auth_dictatorial } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			get_ethics_check_egal_auth = yes
			event_target:chosen_subject = {
				change_government = {
					authority = auth_dictatorial
					remove_invalid_civics = yes
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Imperial
	option = {
		name = veru.4000.imperial
		trigger = {
			event_target:chosen_subject = { NOT = { has_authority = auth_imperial } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_ethics_check_egal_auth = yes
				change_government = {
					authority = auth_imperial
					remove_invalid_civics = yes
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Oligarchic
	option = {
		name = veru.4000.oligarchic
		trigger = {
			event_target:chosen_subject = { is_oligarchic_authority = no }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_ethics_check_fan = yes
				change_government = {
					authority = auth_oligarchic
					remove_invalid_civics = yes
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Democratic Dictatorship (More Authorities)
	option = {
		name = veru.4000.democratic_dictatorship
		trigger = {
			OR = {
				has_ecaf_mod = yes
				has_global_flag = more_authorities_activated
			}
			event_target:chosen_subject = { NOT = { has_authority = auth_dict_democratic } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_ethics_check_fan = yes
				change_government = {
					authority = auth_dict_democratic
					remove_invalid_civics = yes
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Democratic
	option = {
		name = veru.4000.democratic
		trigger = {
			event_target:chosen_subject = { NOT = { has_authority = auth_democratic } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_ethics_check_auth_egal = yes
				change_government = {
					authority = auth_democratic
					remove_invalid_civics = yes
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Single Term Democratic (More Authorities)
	option = {
		name = veru.4000.strict_democratic
		trigger = {
			OR = {
				has_ecaf_mod = yes
				has_global_flag = more_authorities_activated
			}
			event_target:chosen_subject = { NOT = { has_authority = auth_strict_democratic } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_ethics_check_auth_egal = yes
				change_government = {
					authority = auth_strict_democratic
					remove_invalid_civics = yes
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Direct Democratic (Ethics and Civics)
	option = {
		name = veru.4000.direct_democratic
		trigger = {
			has_global_flag = cultural_overhaul_active
			NOT = { has_global_flag = cultural_overhaul_funefork_active }
			event_target:chosen_subject = { NOT = { has_authority = auth_direct_democratic } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_ethics_check_auth_egal = yes
				change_government = {
					authority = auth_direct_democratic
					remove_invalid_civics = yes
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Corporate
	option = {
		name = veru.4000.corporate
		trigger = {
			event_target:chosen_subject = { NOT = { has_authority = auth_corporate } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_remove_civics = yes
				get_ethics_check_fan = yes
				if = {
					limit = { has_global_flag = cultural_overhaul_active }
					get_ethics_check_phobe = yes
					get_ethics_check_soc_cap = yes
				}
				change_government = {
					authority = auth_corporate
					remove_invalid_civics = yes
					civics = random
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Transform into Corporate Imperial (More Authorities)
	option = {
		name = veru.4000.corporate_imperial
		trigger = {
			OR = {
				has_ecaf_mod = yes
				has_global_flag = more_authorities_activated
			}
			event_target:chosen_subject = { NOT = { has_authority = auth_corporate_imperial } }
		}
		allow = {
			custom_tooltip = {
				fail_text = influencefail_text_veru_150
				has_resource = { type = influence amount >= 150 }
			}
		}
		add_resource = { influence = -150 }
		hidden_effect = {
			event_target:chosen_subject = {
				get_remove_civics = yes
				get_ethics_check_egal_auth = yes
				if = {
					limit = { has_global_flag = cultural_overhaul_active }
					get_ethics_check_phobe = yes
					get_ethics_check_soc_cap = yes
				}
				change_government = {
					authority = auth_corporate_imperial
					remove_invalid_civics = yes
					civics = random
					cooldown = no
				}
			}
			get_intervention_effect_gov = yes
		}
	}

	# Back
	option = { name = veru.remain }
}

################
# Leader Installation

# Install New Leader
country_event = {
	id = veru.5000
	title = veru.subject_leader.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.5000.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.5000.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Do something else
	option = {
		name = veru.something_else
		hidden_effect = {
			country_event = { id = veru.1050 }
		}
	}

	# Choose one of our Leaders
	option = {
		name = veru.6400.us
		allow = { num_owned_leaders > 2 }
		hidden_effect = {
			country_event = { id = veru.5010 }
		}
	}

	# Choose one of their Leaders
	option = {
		name = veru.6400.them
		allow = { event_target:chosen_subject = { num_owned_leaders > 2 } }
		hidden_effect = {
			country_event = { id = veru.5020 }
			set_country_flag = install_their_leader
		}
	}

	# Back
	option = { name = veru.remain }
}

# Choose Leader Class
country_event = {
	id = veru.5010
	title = veru.subject_leader.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.5000.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.5000.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Do something else
	option = {
		name = veru.something_else
		hidden_effect = {
			country_event = { id = veru.1050 }
			if = {
				limit = { has_country_flag = install_their_leader }
				remove_country_flag = install_their_leader
			}
		}
	}

	# Change Mind to their Leader
	option = {
		name = veru.their_leaders
		trigger = { NOT = { has_country_flag = install_their_leader } }
		hidden_effect = {
			set_country_flag = install_their_leader
			country_event = { id = veru.5010 }
		}
	}

	# Change Mind to our Leader
	option = {
		name = veru.our_leaders
		trigger = { has_country_flag = install_their_leader }
		hidden_effect = {
			remove_country_flag = install_their_leader
			country_event = { id = veru.5010 }
		}
	}

	# Choose an Official
	option = {
		name = {
			text = veru.5000.official.ours
			trigger = { NOT = { has_country_flag = install_their_leader } }
		}
		name = {
			text = veru.5000.official.theirs
			trigger = { has_country_flag = install_their_leader }
		}
		trigger = {
			OR = {
				AND = {
					NOT = { has_country_flag = install_their_leader }
					any_owned_leader = {
						is_ruler = no
						leader_class = official
					}
				}
				AND = {
					has_country_flag = install_their_leader
					event_target:chosen_subject = {
						any_owned_leader = {
							is_ruler = no
							leader_class = official
						}
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				event_target:chosen_subject = { get_leaders_in_class = { CLASS = official }  }
			}
			else = {
				get_leaders_in_class = { CLASS = official } 
			}
			country_event = { id = veru.5100 }
		}
	}

	# Choose a Commander
	option = {
		name = {
			text = veru.5000.commander.ours
			trigger = { NOT = { has_country_flag = install_their_leader } }
		}
		name = {
			text = veru.5000.commander.theirs
			trigger = { has_country_flag = install_their_leader }
		}
		trigger = {
			OR = {
				AND = {
					NOT = { has_country_flag = install_their_leader }
					any_owned_leader = {
						is_ruler = no
						leader_class = commander
					}
				}
				AND = {
					has_country_flag = install_their_leader
					event_target:chosen_subject = {
						any_owned_leader = {
							is_ruler = no
							leader_class = commander
						}
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				event_target:chosen_subject = { get_leaders_in_class = { CLASS = commander }  }
			}
			else = {
				get_leaders_in_class = { CLASS = commander } 
			}
			country_event = { id = veru.5100 }
		}
	}

	# Choose a Scientist
	option = {
		name = {
			text = veru.5000.scientist.ours
			trigger = { NOT = { has_country_flag = install_their_leader } }
		}
		name = {
			text = veru.5000.scientist.theirs
			trigger = { has_country_flag = install_their_leader }
		}
		trigger = {
			OR = {
				AND = {
					NOT = { has_country_flag = install_their_leader }
					any_owned_leader = {
						is_ruler = no
						leader_class = scientist
					}
				}
				AND = {
					has_country_flag = install_their_leader
					event_target:chosen_subject = {
						any_owned_leader = {
							is_ruler = no
							leader_class = scientist
						}
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				event_target:chosen_subject = { get_leaders_in_class = { CLASS = scientist }  }
			}
			else = {
				get_leaders_in_class = { CLASS = scientist } 
			}
			country_event = { id = veru.5100 }
		}
	}

	# Back
	option = {
		name = veru.remain
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				remove_country_flag = install_their_leader
			}
		}
	}

}

# Choose Leader
country_event = {
	id = veru.5100
	title = veru.subject_leader.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.5000.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.5000.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Maybe a different class
	option = {
		name = veru.another_class
		hidden_effect = {
			country_event = { id = veru.5010 }
		}
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 1 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 2 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 3 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 4 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 5 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 6 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 7 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 8 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 9 }
	}

	option = {
		inline_script = { script = events/install_leader_option NUM = 10 }
	}

	# Back
	option = { name = veru.remain }

	after = {
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				remove_country_flag = install_their_leader
			}
		}
	}
}

#########

# Remove grateful modifier
country_event = {
	id = veru.5900
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		from = { has_leader_flag = grateful_installed_vassal_leader_@this }
		any_playable_country = { has_country_flag = vassal_installer_country_@from }
	}

	immediate = {

		from = {
			save_event_target_as = grateful_leader_not_ruler
		}

		random_country = {
			limit = { has_country_flag = vassal_installer_country_@event_target:grateful_leader_not_ruler }
			remove_country_flag = vassal_installer_country_@event_target:grateful_leader_not_ruler
			save_event_target_as = remove_grateful_modifier_country
		}

		remove_opinion_modifier = {
			who = event_target:remove_grateful_modifier_country
			modifier = opinion_installed_as_vassal_leader
		}
	}
}

#################
# Buffer Zone War

# Get Subjects in buffer zone war
country_event = {
	id = veru.6000
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		set_variable = { which = num_border_subjects value = 0 }
		save_event_target_as = buffer_zone_opponent
		every_subject = {
			limit = {
				any_system_within_border = {
					closest_system = {
						limit = {
							exists = space_owner
							space_owner = {
								OR = {
									is_same_value = event_target:buffer_zone_mother
									AND = {
										has_any_overlord = yes
										overlord = { is_same_value = event_target:buffer_zone_mother }
									}
								}
							}
						}
						use_bypasses = yes
						max_steps = 1
					}
				}
			}
			set_country_flag = border_subject
			prev = { change_variable = { which = num_border_subjects value = 1 } }
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value = 1 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				set_country_flag = chosen_border_subject_@event_target:buffer_zone_mother
				event_target:buffer_zone_mother = { set_country_flag = chosen_border_subject_link_@prev }
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 1 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_1
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 2 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_2
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 3 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_3
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 4 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_4
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 5 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_5
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 6 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_6
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 7 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_7
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 8 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_8
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 9 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_9
			}
		}
		if = {
			limit = { check_variable = { which = num_border_subjects value >= 10 } }
			random_subject = {
				limit = { has_country_flag = border_subject }
				remove_country_flag = border_subject
				save_global_event_target_as = border_subject_10
			}
		}
	}

	after = {
		if = {
			limit = { check_variable = { which = num_border_subjects value > 1 } }
			event_target:buffer_zone_mother = { country_event = { id = veru.6100 } }
		}

		clear_global_event_target = buffer_zone_mother
	}
}

# List Subjects in buffer zone war
country_event = {
	id = veru.6100
	title = veru.6100.name
	desc = veru.6100.desc
	location = from

	diplomatic = yes

	picture_event_data = {
		portrait = from.ruler
		planet_background = from.capital_scope
		graphical_culture = from
		city_level = from.capital_scope
		room = from.ruler
	}

	is_triggered_only = yes

	# Now we show a list of the subject states to the player
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 1 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 2 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 3 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 4 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 5 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 6 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 7 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 8 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 9 }
	}
	option = {
		inline_script = { script = events/buffer_zone_war_option NUM = 10 }
	}
}

country_event = {
	id = veru.6110
	title = veru.6100.name
	desc = veru.6110.desc
	location = event_target:chosen_border_subject_final.capital_scope

	diplomatic = yes

	picture_event_data = {
		portrait = from.ruler
		planet_background = from.capital_scope
		graphical_culture = from
		city_level = from.capital_scope
		room = from.ruler
	}

	is_triggered_only = yes

	option = {
		name = WILL_FAIL
	}
}

#################
# Buffer Zone War Events, called via wargoal

# War Won - Switch subject overlord
country_event = {
	id = veru.6200
	hide_window = yes
	is_triggered_only = yes

	immediate = {

		event_target:buffer_zone_transition = { save_event_target_as = buffer_zone_winner }
		clear_global_event_target = buffer_zone_transition

		random_subject = {
			limit = { has_country_flag = chosen_border_subject_@event_target:buffer_zone_winner }
			remove_country_flag = chosen_border_subject_@event_target:buffer_zone_winner

			
			if = {
				limit = { is_tributary = yes }
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_tributary
				}
			}
			else_if = {
				limit = {
					is_ver_clientkingdom = yes
					event_target:buffer_zone_winner = { is_gestalt = no }
				}
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_clientkingdom
				}
			}
			else_if = {
				limit = {
					is_ver_foederatus = yes
					event_target:buffer_zone_winner = { is_gestalt = no }
				}
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_foederatus
				}
			}
			else_if = {
				limit = { is_ver_condo = yes }
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_condo
				}
			}
			else_if = {
				limit = {
					is_ver_satellite = yes
					event_target:buffer_zone_winner = { is_gestalt = no }
				}
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_satellite
				}
			}
			else_if = {
				limit = { is_ver_jrpartner = yes }
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_jrpartner
				}
			}
			else_if = {
				limit = {
					is_ver_dependency = yes
					event_target:buffer_zone_winner = { is_gestalt = no }
				}
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_dependency
				}
			}
			else_if = {
				limit = {
					is_ver_devolved = yes
					event_target:buffer_zone_winner = { is_gestalt = no }
				}
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_devolved
				}
			}
			else_if = {
				limit = { is_ver_puppet = yes }
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_puppet
				}
			}
			else_if = {
				limit = {
					is_ver_neocolony = yes
					event_target:buffer_zone_winner = {
						is_gestalt = no
						is_socialist = no
					}
				}
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_neocolony
				}
			}
			else_if = {
				limit = {
					is_ver_blood = yes
					event_target:buffer_zone_winner = {
						is_gestalt = no
						NOT = { any_subject = { is_ver_blood = yes } }
						OR = {
							is_death_cult_empire = yes
							has_ver_blood_civic = yes
						}
					}
				}
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_ver_blood
				}
			}
			else = {
				set_subject_of = {
					who = event_target:buffer_zone_winner
					preset = preset_vassal
				}
			}
			
			save_event_target_as = chosen_subject
		}
	}

	after = {
		event_target:buffer_zone_winner = {
			country_event = { id = veru.6400 days = 3 }
		}
	}
}

# Status Quo - Remove subject flag
country_event = {
	id = veru.6210
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		random_subject = {
			limit = { has_country_flag = chosen_border_subject_@event_target:buffer_zone_loser }
			remove_country_flag = chosen_border_subject_@event_target:buffer_zone_loser
		}
	}
}

# War Lost - Remove subject flag
country_event = {
	id = veru.6220
	hide_window = yes
	is_triggered_only = yes

	immediate = {
		save_event_target_as = buffer_zone_loser
		from = {
			random_subject = {
				limit = { has_country_flag = chosen_border_subject_@event_target:buffer_zone_loser }
				remove_country_flag = chosen_border_subject_@event_target:buffer_zone_loser
			}
		}
	}
}

###############################
# After War Leader Installation

# Install New Leader after buffer zone war or when CK ruler dies
country_event = {
	id = veru.6400
	title = veru.6400.name
	desc = veru.6400.desc
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	desc = {
		text = veru.6400.desc
		trigger = { event_target:chosen_subject = { is_ver_clientkingdom = no } }
	}

	desc = {
		text = veru.6400.clientkingdom
		trigger = {
			NOT = { has_country_flag = ck_desc }
			event_target:chosen_subject = { is_ver_clientkingdom = yes }
		}
	}

	desc = {
		text = veru.6400.clientkingdom_passes
		trigger = {
			has_country_flag = ck_desc
			event_target:chosen_subject = { is_ver_clientkingdom = yes }
		}
	}

	picture_event_data = {
		portrait = root.ruler
		planet_background = event_target:chosen_subject
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject.capital_scope
		room = event_target:chosen_subject.ruler
	}

	# Choose one of their leaders
	option = {
		name = veru.6400.them
		custom_tooltip = veru.6400.them.tooltip
		allow = { event_target:chosen_subject = { num_owned_leaders > 2 } }
		trigger = { event_target:chosen_subject = { is_ver_clientkingdom = no } }
		hidden_effect = {
			country_event = { id = veru.6600 }
			set_country_flag = install_their_leader
		}
		ai_chance = { base = 5 }
	}

	# Choose one of their leaders
	option = {
		name = veru.6400.them
		allow = { event_target:chosen_subject = { num_owned_leaders > 2 } }
		trigger = { event_target:chosen_subject = { is_ver_clientkingdom = yes } }
		hidden_effect = {
			country_event = { id = veru.6600 }
			set_country_flag = install_their_leader
		}
		ai_chance = { base = 5 }
	}

	# Choose one of our leaders
	option = {
		name = veru.6400.us
		custom_tooltip = veru.6400.us.tooltip
		allow = { num_owned_leaders > 2 }
		trigger = { event_target:chosen_subject = { is_ver_clientkingdom = no } }
		hidden_effect = {
			country_event = { id = veru.6600 }
		}
		ai_chance = { base = 2 }
	}

	# Choose one of our leaders
	option = {
		name = veru.6400.us
		allow = { num_owned_leaders > 2 }
		trigger = { event_target:chosen_subject = { is_ver_clientkingdom = yes } }
		hidden_effect = {
			country_event = { id = veru.6600 }
		}
		ai_chance = { base = 2 }
	}
}

# Installed leader's Class
country_event = {
	id = veru.6600
	title = veru.6400.name
	desc = veru.6510.desc
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = root.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	# Change Mind to their Leader
	option = {
		name = veru.their_leaders
		trigger = { NOT = { has_country_flag = install_their_leader } }
		hidden_effect = {
			set_country_flag = install_their_leader
			country_event = { id = veru.6600 }
		}
	}

	# Change Mind to our Leader
	option = {
		name = veru.our_leaders
		trigger = { has_country_flag = install_their_leader }
		hidden_effect = {
			remove_country_flag = install_their_leader
			country_event = { id = veru.5010 }
		}
	}

	# Choose one of our Officials
	option = {
		name = {
			text = veru.5000.official.ours
			trigger = { NOT = { has_country_flag = install_their_leader } }
		}
		name = {
			text = veru.5000.official.theirs
			trigger = { has_country_flag = install_their_leader }
		}
		trigger = {
			OR = {
				AND = {
					NOT = { has_country_flag = install_their_leader }
					any_owned_leader = {
						is_ruler = no
						leader_class = official
					}
				}
				AND = {
					has_country_flag = install_their_leader
					event_target:chosen_subject = {
						any_owned_leader = {
							is_ruler = no
							leader_class = official
						}
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				event_target:chosen_subject = { get_leaders_in_class = { CLASS = official }  }
			}
			else = {
				get_leaders_in_class = { CLASS = official } 
			}
			country_event = { id = veru.6610 }
		}
	}

	# Choose one of our Commanders
	option = {
		name = {
			text = veru.5000.commander.ours
			trigger = { NOT = { has_country_flag = install_their_leader } }
		}
		name = {
			text = veru.5000.commander.theirs
			trigger = { has_country_flag = install_their_leader }
		}
		trigger = {
			OR = {
				AND = {
					NOT = { has_country_flag = install_their_leader }
					any_owned_leader = {
						is_ruler = no
						leader_class = commander
					}
				}
				AND = {
					has_country_flag = install_their_leader
					event_target:chosen_subject = {
						any_owned_leader = {
							is_ruler = no
							leader_class = commander
						}
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				event_target:chosen_subject = { get_leaders_in_class = { CLASS = commander }  }
			}
			else = {
				get_leaders_in_class = { CLASS = commander } 
			}
			country_event = { id = veru.6610 }
		}
	}

	# Choose one of our Scientists
	option = {
		name = {
			text = veru.5000.scientist.ours
			trigger = { NOT = { has_country_flag = install_their_leader } }
		}
		name = {
			text = veru.5000.scientist.theirs
			trigger = { has_country_flag = install_their_leader }
		}
		trigger = {
			OR = {
				AND = {
					NOT = { has_country_flag = install_their_leader }
					any_owned_leader = {
						is_ruler = no
						leader_class = scientist
					}
				}
				AND = {
					has_country_flag = install_their_leader
					event_target:chosen_subject = {
						any_owned_leader = {
							is_ruler = no
							leader_class = scientist
						}
					}
				}
			}
		}
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				event_target:chosen_subject = { get_leaders_in_class = { CLASS = scientist }  }
			}
			else = {
				get_leaders_in_class = { CLASS = scientist } 
			}
			country_event = { id = veru.6610 }
		}
	}
}

# Choose Leader
country_event = {
	id = veru.6610
	title = veru.6400.name
	desc = veru.6510.desc
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = root.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	# Maybe a different class
	option = {
		name = veru.another_class
		hidden_effect = {
			country_event = { id = veru.6600 }
		}
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 1 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 2 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 3 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 4 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 5 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 6 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 7 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 8 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 9 }
	}

	option = {
		inline_script = { script = events/install_leader_option_ck NUM = 10 }
	}

	after = {
		hidden_effect = {
			if = {
				limit = { has_country_flag = install_their_leader }
				remove_country_flag = install_their_leader
			}
		}
	}
}

################
# Capital Relocation

# Choose their capital
country_event = {
	id = veru.6700
	title = veru.subject_leader.name
	location = event_target:chosen_subject
	hide_window = no
	is_triggered_only = yes

	diplomatic = yes

	picture_event_data = {
		portrait = event_target:chosen_subject.ruler
		planet_background = event_target:chosen_subject.capital_scope
		graphical_culture = event_target:chosen_subject
		city_level = event_target:chosen_subject
		room = event_target:chosen_subject.ruler
	}

	desc = {
		text = veru.6700.loyal.desc
		trigger = { event_target:chosen_subject = { is_loyal_to = prev } }
	}

	desc = {
		text = veru.6700.disloyal.desc
		trigger = { event_target:chosen_subject = { is_disloyal_to = prev } }
	}

	# Do something else
	option = {
		name = veru.something_else
		hidden_effect = {
			country_event = { id = veru.1050 }
		}
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 1 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 2 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 3 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 4 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 5 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 6 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 7 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 8 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 9 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 10 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 11 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 12 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 13 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 14 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 15 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 16 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 17 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 18 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 19 }
	}

	option = {
		inline_script = { script = events/capital_relocation_option NUM = 20 }
	}

	# Back
	option = { name = veru.nevermind }
}